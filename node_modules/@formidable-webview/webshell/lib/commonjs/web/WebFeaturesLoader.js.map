{"version":3,"sources":["WebFeaturesLoader.ts"],"names":["serializeFeature","feature","script","JSON","stringify","identifier","options","registerFeature","feat","assembleScript","feats","featuresLoaderScript","map","join","WebFeaturesLoader","features","assembledFeaturesScript"],"mappings":";;;;;;;;;;;;;;AAIA,SAASA,gBAAT,CAA0BC,OAA1B,EAAuE;AACrE,2BAAkBA,OAAO,CAACC,MAA1B,yBAA+CC,IAAI,CAACC,SAAL,CAC7CH,OAAO,CAACI,UADqC,CAA/C,sBAEaF,IAAI,CAACC,SAAL,CAAeH,OAAO,CAACK,OAAR,IAAmB,EAAlC,CAFb;AAGD;;AAED,SAASC,eAAT,CAAyBC,IAAzB,EAAkD;AAChD,yEAC+CR,gBAAgB,CAACQ,IAAD,CAD/D,kFAGgDL,IAAI,CAACC,SAAL,CAC5CI,IAAI,CAACH,UADuC,CAHhD;AAOD;;AAED,SAASI,cAAT,CAAwBC,KAAxB,EAAoD;AAClD,mBAAUC,oBAAV,yBAA6CD,KAAK,CAC/CE,GAD0C,CACtCL,eADsC,EAE1CM,IAF0C,CAErC,IAFqC,CAA7C;AAGD;;IAEYC,iB,GAGX,2BAAYC,QAAZ,EAAyB;AAAA;;AAAA;;AAAA;;AACvB,OAAKA,QAAL,GAAgBA,QAAhB;AACA,OAAKC,uBAAL,GAA+BP,cAAc,CAACM,QAAD,CAA7C;AACD,C","sourcesContent":["import Feature from '../Feature';\nimport featuresLoaderScript from './web-features-loader.webjs';\nimport { PropsSpecs } from '../types';\n\nfunction serializeFeature(feature: Feature<any, PropsSpecs<any, any>>) {\n  return `{source:${feature.script},identifier:${JSON.stringify(\n    feature.identifier\n  )},options:${JSON.stringify(feature.options || {})}}`;\n}\n\nfunction registerFeature(feat: Feature<any, any>) {\n  return `try {\n    window.ReactNativeWebshell.registerFeature(${serializeFeature(feat)});\n  } catch (e) {\n    window.ReactNativeWebshell.sendErrorMessage(${JSON.stringify(\n      feat.identifier\n    )},e);\n  };`;\n}\n\nfunction assembleScript(feats: Feature<any, any>[]) {\n  return `${featuresLoaderScript}(function(){${feats\n    .map(registerFeature)\n    .join('\\n')};})();`;\n}\n\nexport class WebFeaturesLoader<F extends Feature<any, any>[]> {\n  readonly features: F;\n  readonly assembledFeaturesScript: string;\n  constructor(features: F) {\n    this.features = features;\n    this.assembledFeaturesScript = assembleScript(features);\n  }\n}\n"]}